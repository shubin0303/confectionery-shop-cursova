name: Telegram Bot Runner

on:
  workflow_dispatch:  # –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
  push:
    branches: [ main ]
  schedule:
    - cron: '*/25 * * * *'  # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–µ 25 –º–∏–Ω—É—Ç

jobs:
  run-bot:
    runs-on: ubuntu-latest
    timeout-minutes: 24  # –ù–∞ 1 –º–∏–Ω—É—Ç—É –º–µ–Ω—å—à–µ —á–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª
    
    steps:
    - name: üì• –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
      uses: actions/checkout@v4
      
    - name: ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
      run: npm install
      
    - name: ü§ñ –ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞
      run: |
        echo "üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ $(date)"
        echo "–¢–æ–∫–µ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: ${#TELEGRAM_BOT_TOKEN} —Å–∏–º–≤–æ–ª–æ–≤"
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º 23 –º–∏–Ω—É—Ç—ã
        timeout 1380 node bot.js || true
        
        echo "‚è∞ –ë–æ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã"
        
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
